root        :           statements
            |

statements  :           statements \n statement
            |           statements , statement
            |           statement

statement   :           EXIT
            |           expr
            |           ids_assign expr
            |           func_shape ASSIGN expr
            |           CALC ID
            |           POLAR expr
            |           expr POLAR
            |           VARS
            |           NEW

func_shape  :           ID LPAREN exprs expr RPAREN
            |           ID LPAREN expr RPAREN

ids_assign  :           ID ASSIGN
            |           ids_assign ID ASSIGN

expr        :           expr + expr
            |           expr - expr
            |           expr * expr
            |           expr / expr
            |           expr ^ expr
            |           - expr                          %prec UMINUS
            |           NUMBER
            |           mini_term
            |           PIPE expr PIPE
            |           expr THEN expr
            |           expr THEN ' ID expr '
            |           expr WITH with_assigns
            |           INT expr FROM expr TO expr SEMI

exprs       :           expr COMMA
            |           exprs expr COMMA

with_assigns:           ID ASSIGN expr SEMI
            |           with_assigns ID ASSIGN expr SEMI

mini_term   :           ID
            |           NUMBER mini_term                %prec CONSTANT
            |           LPAREN expr RPAREN mini_term    %prec CONSTANT
            |           NUMBER mini_term POW expr
            |           MATHFUNC LPAREN expr RPAREN
            |           func_shape
            |           LPAREN expr RPAREN

------

precedence = (
    ('right', ASSIGN),
    ('left', THEN),
    ('left', PLUS, MINUS),
    ('left', TIMES, DIV),
    ('right', CONSTANT),
    ('right', MATHFUNC, UMINUS),
    ('right', POW),
)